<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link href="html.css" rel="stylesheet" type="text/css">
</head>
<body>
<table><tr>
<td class="linescolumn"><a id="L1" href="#L1">1</a><a id="L2" href="#L2">2</a><a id="L3" href="#L3">3</a><a id="L4" href="#L4">4</a><a id="L5" href="#L5">5</a><a id="L6" href="#L6">6</a><a id="L7" href="#L7">7</a><a id="L8" href="#L8">8</a><a id="L9" href="#L9">9</a><a id="L10" href="#L10">10</a><a id="L11" href="#L11">11</a><a id="L12" href="#L12">12</a><a id="L13" href="#L13">13</a><a id="L14" href="#L14">14</a><a id="L15" href="#L15">15</a><a id="L16" href="#L16">16</a><a id="L17" href="#L17">17</a><a id="L18" href="#L18">18</a><a id="L19" href="#L19">19</a><a id="L20" href="#L20">20</a><a id="L21" href="#L21">21</a><a id="L22" href="#L22">22</a><a id="L23" href="#L23">23</a><a id="L24" href="#L24">24</a><a id="L25" href="#L25">25</a><a id="L26" href="#L26">26</a><a id="L27" href="#L27">27</a><a id="L28" href="#L28">28</a><a id="L29" href="#L29">29</a><a id="L30" href="#L30">30</a><a id="L31" href="#L31">31</a><a id="L32" href="#L32">32</a><a id="L33" href="#L33">33</a><a id="L34" href="#L34">34</a><a id="L35" href="#L35">35</a><a id="L36" href="#L36">36</a><a id="L37" href="#L37">37</a><a id="L38" href="#L38">38</a><a id="L39" href="#L39">39</a><a id="L40" href="#L40">40</a><a id="L41" href="#L41">41</a><a id="L42" href="#L42">42</a><a id="L43" href="#L43">43</a><a id="L44" href="#L44">44</a><a id="L45" href="#L45">45</a><a id="L46" href="#L46">46</a><a id="L47" href="#L47">47</a><a id="L48" href="#L48">48</a><a id="L49" href="#L49">49</a><a id="L50" href="#L50">50</a><a id="L51" href="#L51">51</a><a id="L52" href="#L52">52</a><a id="L53" href="#L53">53</a><a id="L54" href="#L54">54</a><a id="L55" href="#L55">55</a><a id="L56" href="#L56">56</a><a id="L57" href="#L57">57</a><a id="L58" href="#L58">58</a><a id="L59" href="#L59">59</a><a id="L60" href="#L60">60</a><a id="L61" href="#L61">61</a><a id="L62" href="#L62">62</a><a id="L63" href="#L63">63</a><a id="L64" href="#L64">64</a><a id="L65" href="#L65">65</a><a id="L66" href="#L66">66</a><a id="L67" href="#L67">67</a><a id="L68" href="#L68">68</a><a id="L69" href="#L69">69</a><a id="L70" href="#L70">70</a><a id="L71" href="#L71">71</a><a id="L72" href="#L72">72</a><a id="L73" href="#L73">73</a><a id="L74" href="#L74">74</a><a id="L75" href="#L75">75</a><a id="L76" href="#L76">76</a><a id="L77" href="#L77">77</a><a id="L78" href="#L78">78</a><a id="L79" href="#L79">79</a><a id="L80" href="#L80">80</a><a id="L81" href="#L81">81</a><a id="L82" href="#L82">82</a><a id="L83" href="#L83">83</a><a id="L84" href="#L84">84</a><a id="L85" href="#L85">85</a><a id="L86" href="#L86">86</a><a id="L87" href="#L87">87</a><a id="L88" href="#L88">88</a><a id="L89" href="#L89">89</a><a id="L90" href="#L90">90</a><a id="L91" href="#L91">91</a><a id="L92" href="#L92">92</a><a id="L93" href="#L93">93</a><a id="L94" href="#L94">94</a><a id="L95" href="#L95">95</a><a id="L96" href="#L96">96</a><a id="L97" href="#L97">97</a><a id="L98" href="#L98">98</a><a id="L99" href="#L99">99</a><a id="L100" href="#L100">100</a><a id="L101" href="#L101">101</a><a id="L102" href="#L102">102</a><a id="L103" href="#L103">103</a><a id="L104" href="#L104">104</a><a id="L105" href="#L105">105</a><a id="L106" href="#L106">106</a><a id="L107" href="#L107">107</a><a id="L108" href="#L108">108</a><a id="L109" href="#L109">109</a><a id="L110" href="#L110">110</a><a id="L111" href="#L111">111</a><a id="L112" href="#L112">112</a><a id="L113" href="#L113">113</a><a id="L114" href="#L114">114</a><a id="L115" href="#L115">115</a><a id="L116" href="#L116">116</a><a id="L117" href="#L117">117</a><a id="L118" href="#L118">118</a><a id="L119" href="#L119">119</a><a id="L120" href="#L120">120</a><a id="L121" href="#L121">121</a><a id="L122" href="#L122">122</a><a id="L123" href="#L123">123</a><a id="L124" href="#L124">124</a><a id="L125" href="#L125">125</a><a id="L126" href="#L126">126</a><a id="L127" href="#L127">127</a><a id="L128" href="#L128">128</a><a id="L129" href="#L129">129</a><a id="L130" href="#L130">130</a><a id="L131" href="#L131">131</a><a id="L132" href="#L132">132</a><a id="L133" href="#L133">133</a><a id="L134" href="#L134">134</a><a id="L135" href="#L135">135</a><a id="L136" href="#L136">136</a><a id="L137" href="#L137">137</a><a id="L138" href="#L138">138</a><a id="L139" href="#L139">139</a><a id="L140" href="#L140">140</a><a id="L141" href="#L141">141</a><a id="L142" href="#L142">142</a><a id="L143" href="#L143">143</a><a id="L144" href="#L144">144</a><a id="L145" href="#L145">145</a><a id="L146" href="#L146">146</a><a id="L147" href="#L147">147</a><a id="L148" href="#L148">148</a><a id="L149" href="#L149">149</a><a id="L150" href="#L150">150</a><a id="L151" href="#L151">151</a><a id="L152" href="#L152">152</a><a id="L153" href="#L153">153</a><a id="L154" href="#L154">154</a><a id="L155" href="#L155">155</a><a id="L156" href="#L156">156</a><a id="L157" href="#L157">157</a><a id="L158" href="#L158">158</a><a id="L159" href="#L159">159</a><a id="L160" href="#L160">160</a><a id="L161" href="#L161">161</a><a id="L162" href="#L162">162</a><a id="L163" href="#L163">163</a><a id="L164" href="#L164">164</a><a id="L165" href="#L165">165</a><a id="L166" href="#L166">166</a><a id="L167" href="#L167">167</a><a id="L168" href="#L168">168</a><a id="L169" href="#L169">169</a><a id="L170" href="#L170">170</a><a id="L171" href="#L171">171</a><a id="L172" href="#L172">172</a><a id="L173" href="#L173">173</a><a id="L174" href="#L174">174</a><a id="L175" href="#L175">175</a><a id="L176" href="#L176">176</a><a id="L177" href="#L177">177</a><a id="L178" href="#L178">178</a><a id="L179" href="#L179">179</a><a id="L180" href="#L180">180</a><a id="L181" href="#L181">181</a><a id="L182" href="#L182">182</a><a id="L183" href="#L183">183</a><a id="L184" href="#L184">184</a><a id="L185" href="#L185">185</a><a id="L186" href="#L186">186</a><a id="L187" href="#L187">187</a><a id="L188" href="#L188">188</a><a id="L189" href="#L189">189</a><a id="L190" href="#L190">190</a><a id="L191" href="#L191">191</a><a id="L192" href="#L192">192</a><a id="L193" href="#L193">193</a><a id="L194" href="#L194">194</a><a id="L195" href="#L195">195</a><a id="L196" href="#L196">196</a><a id="L197" href="#L197">197</a><a id="L198" href="#L198">198</a><a id="L199" href="#L199">199</a><a id="L200" href="#L200">200</a><a id="L201" href="#L201">201</a><a id="L202" href="#L202">202</a><a id="L203" href="#L203">203</a><a id="L204" href="#L204">204</a><a id="L205" href="#L205">205</a><a id="L206" href="#L206">206</a><a id="L207" href="#L207">207</a><a id="L208" href="#L208">208</a><a id="L209" href="#L209">209</a><a id="L210" href="#L210">210</a><a id="L211" href="#L211">211</a><a id="L212" href="#L212">212</a><a id="L213" href="#L213">213</a><a id="L214" href="#L214">214</a><a id="L215" href="#L215">215</a><a id="L216" href="#L216">216</a><a id="L217" href="#L217">217</a><a id="L218" href="#L218">218</a><a id="L219" href="#L219">219</a><a id="L220" href="#L220">220</a><a id="L221" href="#L221">221</a><a id="L222" href="#L222">222</a><a id="L223" href="#L223">223</a><a id="L224" href="#L224">224</a><a id="L225" href="#L225">225</a><a id="L226" href="#L226">226</a><a id="L227" href="#L227">227</a><a id="L228" href="#L228">228</a><a id="L229" href="#L229">229</a><a id="L230" href="#L230">230</a><a id="L231" href="#L231">231</a><a id="L232" href="#L232">232</a><a id="L233" href="#L233">233</a><a id="L234" href="#L234">234</a><a id="L235" href="#L235">235</a><a id="L236" href="#L236">236</a><a id="L237" href="#L237">237</a><a id="L238" href="#L238">238</a><a id="L239" href="#L239">239</a><a id="L240" href="#L240">240</a><a id="L241" href="#L241">241</a><a id="L242" href="#L242">242</a><a id="L243" href="#L243">243</a><a id="L244" href="#L244">244</a><a id="L245" href="#L245">245</a><a id="L246" href="#L246">246</a><a id="L247" href="#L247">247</a><a id="L248" href="#L248">248</a><a id="L249" href="#L249">249</a><a id="L250" href="#L250">250</a><a id="L251" href="#L251">251</a><a id="L252" href="#L252">252</a><a id="L253" href="#L253">253</a><a id="L254" href="#L254">254</a><a id="L255" href="#L255">255</a><a id="L256" href="#L256">256</a><a id="L257" href="#L257">257</a><a id="L258" href="#L258">258</a><a id="L259" href="#L259">259</a><a id="L260" href="#L260">260</a><a id="L261" href="#L261">261</a><a id="L262" href="#L262">262</a><a id="L263" href="#L263">263</a><a id="L264" href="#L264">264</a><a id="L265" href="#L265">265</a><a id="L266" href="#L266">266</a><a id="L267" href="#L267">267</a><a id="L268" href="#L268">268</a><a id="L269" href="#L269">269</a><a id="L270" href="#L270">270</a><a id="L271" href="#L271">271</a><a id="L272" href="#L272">272</a><a id="L273" href="#L273">273</a><a id="L274" href="#L274">274</a><a id="L275" href="#L275">275</a><a id="L276" href="#L276">276</a><a id="L277" href="#L277">277</a><a id="L278" href="#L278">278</a><a id="L279" href="#L279">279</a><a id="L280" href="#L280">280</a><a id="L281" href="#L281">281</a><a id="L282" href="#L282">282</a><a id="L283" href="#L283">283</a><a id="L284" href="#L284">284</a><a id="L285" href="#L285">285</a><a id="L286" href="#L286">286</a><a id="L287" href="#L287">287</a><a id="L288" href="#L288">288</a><a id="L289" href="#L289">289</a><a id="L290" href="#L290">290</a><a id="L291" href="#L291">291</a><a id="L292" href="#L292">292</a><a id="L293" href="#L293">293</a><a id="L294" href="#L294">294</a><a id="L295" href="#L295">295</a><a id="L296" href="#L296">296</a><a id="L297" href="#L297">297</a><a id="L298" href="#L298">298</a><a id="L299" href="#L299">299</a><a id="L300" href="#L300">300</a><a id="L301" href="#L301">301</a><a id="L302" href="#L302">302</a><a id="L303" href="#L303">303</a><a id="L304" href="#L304">304</a><a id="L305" href="#L305">305</a><a id="L306" href="#L306">306</a><a id="L307" href="#L307">307</a><a id="L308" href="#L308">308</a><a id="L309" href="#L309">309</a><a id="L310" href="#L310">310</a><a id="L311" href="#L311">311</a><a id="L312" href="#L312">312</a><a id="L313" href="#L313">313</a><a id="L314" href="#L314">314</a><a id="L315" href="#L315">315</a><a id="L316" href="#L316">316</a><a id="L317" href="#L317">317</a><a id="L318" href="#L318">318</a><a id="L319" href="#L319">319</a><a id="L320" href="#L320">320</a><a id="L321" href="#L321">321</a><a id="L322" href="#L322">322</a><a id="L323" href="#L323">323</a><a id="L324" href="#L324">324</a><a id="L325" href="#L325">325</a><a id="L326" href="#L326">326</a><a id="L327" href="#L327">327</a><a id="L328" href="#L328">328</a><a id="L329" href="#L329">329</a><a id="L330" href="#L330">330</a><a id="L331" href="#L331">331</a><a id="L332" href="#L332">332</a><a id="L333" href="#L333">333</a><a id="L334" href="#L334">334</a><a id="L335" href="#L335">335</a><a id="L336" href="#L336">336</a><a id="L337" href="#L337">337</a><a id="L338" href="#L338">338</a><a id="L339" href="#L339">339</a><a id="L340" href="#L340">340</a><a id="L341" href="#L341">341</a><a id="L342" href="#L342">342</a><a id="L343" href="#L343">343</a><a id="L344" href="#L344">344</a><a id="L345" href="#L345">345</a><a id="L346" href="#L346">346</a><a id="L347" href="#L347">347</a><a id="L348" href="#L348">348</a><a id="L349" href="#L349">349</a><a id="L350" href="#L350">350</a><a id="L351" href="#L351">351</a><a id="L352" href="#L352">352</a><a id="L353" href="#L353">353</a><a id="L354" href="#L354">354</a><a id="L355" href="#L355">355</a><a id="L356" href="#L356">356</a><a id="L357" href="#L357">357</a><a id="L358" href="#L358">358</a><a id="L359" href="#L359">359</a><a id="L360" href="#L360">360</a><a id="L361" href="#L361">361</a><a id="L362" href="#L362">362</a><a id="L363" href="#L363">363</a><a id="L364" href="#L364">364</a><a id="L365" href="#L365">365</a><a id="L366" href="#L366">366</a><a id="L367" href="#L367">367</a><a id="L368" href="#L368">368</a><a id="L369" href="#L369">369</a><a id="L370" href="#L370">370</a><a id="L371" href="#L371">371</a><a id="L372" href="#L372">372</a><a id="L373" href="#L373">373</a><a id="L374" href="#L374">374</a><a id="L375" href="#L375">375</a><a id="L376" href="#L376">376</a><a id="L377" href="#L377">377</a><a id="L378" href="#L378">378</a><a id="L379" href="#L379">379</a><a id="L380" href="#L380">380</a><a id="L381" href="#L381">381</a><a id="L382" href="#L382">382</a><a id="L383" href="#L383">383</a><a id="L384" href="#L384">384</a><a id="L385" href="#L385">385</a><a id="L386" href="#L386">386</a><a id="L387" href="#L387">387</a><a id="L388" href="#L388">388</a><a id="L389" href="#L389">389</a><a id="L390" href="#L390">390</a><a id="L391" href="#L391">391</a><a id="L392" href="#L392">392</a><a id="L393" href="#L393">393</a><a id="L394" href="#L394">394</a><a id="L395" href="#L395">395</a><a id="L396" href="#L396">396</a><a id="L397" href="#L397">397</a><a id="L398" href="#L398">398</a><a id="L399" href="#L399">399</a><a id="L400" href="#L400">400</a><a id="L401" href="#L401">401</a><a id="L402" href="#L402">402</a><a id="L403" href="#L403">403</a><a id="L404" href="#L404">404</a><a id="L405" href="#L405">405</a><a id="L406" href="#L406">406</a><a id="L407" href="#L407">407</a><a id="L408" href="#L408">408</a><a id="L409" href="#L409">409</a><a id="L410" href="#L410">410</a><a id="L411" href="#L411">411</a><a id="L412" href="#L412">412</a><a id="L413" href="#L413">413</a><a id="L414" href="#L414">414</a><a id="L415" href="#L415">415</a><a id="L416" href="#L416">416</a><a id="L417" href="#L417">417</a><a id="L418" href="#L418">418</a><a id="L419" href="#L419">419</a><a id="L420" href="#L420">420</a><a id="L421" href="#L421">421</a><a id="L422" href="#L422">422</a><a id="L423" href="#L423">423</a><a id="L424" href="#L424">424</a><a id="L425" href="#L425">425</a><a id="L426" href="#L426">426</a><a id="L427" href="#L427">427</a><a id="L428" href="#L428">428</a><a id="L429" href="#L429">429</a><a id="L430" href="#L430">430</a><a id="L431" href="#L431">431</a><a id="L432" href="#L432">432</a><a id="L433" href="#L433">433</a><a id="L434" href="#L434">434</a><a id="L435" href="#L435">435</a><a id="L436" href="#L436">436</a><a id="L437" href="#L437">437</a><a id="L438" href="#L438">438</a><a id="L439" href="#L439">439</a><a id="L440" href="#L440">440</a><a id="L441" href="#L441">441</a><a id="L442" href="#L442">442</a><a id="L443" href="#L443">443</a><a id="L444" href="#L444">444</a><a id="L445" href="#L445">445</a><a id="L446" href="#L446">446</a><a id="L447" href="#L447">447</a><a id="L448" href="#L448">448</a><a id="L449" href="#L449">449</a><a id="L450" href="#L450">450</a><a id="L451" href="#L451">451</a><a id="L452" href="#L452">452</a><a id="L453" href="#L453">453</a><a id="L454" href="#L454">454</a><a id="L455" href="#L455">455</a><a id="L456" href="#L456">456</a><a id="L457" href="#L457">457</a><a id="L458" href="#L458">458</a><a id="L459" href="#L459">459</a><a id="L460" href="#L460">460</a><a id="L461" href="#L461">461</a><a id="L462" href="#L462">462</a><a id="L463" href="#L463">463</a><a id="L464" href="#L464">464</a><a id="L465" href="#L465">465</a><a id="L466" href="#L466">466</a><a id="L467" href="#L467">467</a><a id="L468" href="#L468">468</a><a id="L469" href="#L469">469</a><a id="L470" href="#L470">470</a><a id="L471" href="#L471">471</a><a id="L472" href="#L472">472</a><a id="L473" href="#L473">473</a><a id="L474" href="#L474">474</a><a id="L475" href="#L475">475</a><a id="L476" href="#L476">476</a><a id="L477" href="#L477">477</a><a id="L478" href="#L478">478</a><a id="L479" href="#L479">479</a><a id="L480" href="#L480">480</a></td>
<td><td><pre class="sourcecode">
<span class="bc">/* md5.d - RSA Data Security, Inc., MD5 message-digest algorithm
 * Derived from the RSA Data Security, Inc. MD5 Message-Digest Algorithm.
 */</span>

<span class="bc">/**
 * Computes MD5 digests of arbitrary data. MD5 digests are 16 byte quantities that are like a checksum or crc, but are more robust. 
 *
 * There are two ways to do this. The first does it all in one function call to
 * sum(). The second is for when the data is buffered. 
 *
 * Bugs:
 * MD5 digests have been demonstrated to not be unique.
 *
 * Author:
 * The routines and algorithms are derived from the
 * $(I RSA Data Security, Inc. MD5 Message-Digest Algorithm).
 *
 * References:
 *	$(LINK2 http://en.wikipedia.org/wiki/Md5, Wikipedia on MD5)
 *
 * Macros:
 *	WIKI = Phobos/StdMd5
 */</span>

<span class="nc">/++++++++++++++++++++++++++++++++
 Example:

--------------------
// This code is derived from the
// RSA Data Security, Inc. MD5 Message-Digest Algorithm.

import std.md5;

private import std.stdio;
private import std.string;
private import std.c.stdio;
private import std.c.string;

int main(char[][] args)
{
    foreach (char[] arg; args)
	 MDFile(arg);
    return 0;
}

/* Digests a file and prints the result. */
void MDFile(char[] filename)
{
    FILE* file;
    MD5_CTX context;
    int len;
    ubyte[4 * 1024] buffer;
    ubyte digest[16];

    if ((file = fopen(std.string.toStringz(filename), "rb")) == null)
	writefln("%s can't be opened", filename);
    else
    {
	context.start();
	while ((len = fread(buffer, 1, buffer.sizeof, file)) != 0)
	    context.update(buffer[0 .. len]);
	context.finish(digest);
	fclose(file);

	writefln("MD5 (%s) = %s", filename, digestToString(digest));
    }
}
--------------------
 +/</span>

<span class="bc">/* Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
rights reserved.

License to copy and use this software is granted provided that it
is identified as the "RSA Data Security, Inc. MD5 Message-Digest
Algorithm" in all material mentioning or referencing this software
or this function.

License is also granted to make and use derivative works provided
that such works are identified as "derived from the RSA Data
Security, Inc. MD5 Message-Digest Algorithm" in all material
mentioning or referencing the derived work.

RSA Data Security, Inc. makes no representations concerning either
the merchantability of this software or the suitability of this
software for any particular purpose. It is provided "as is"
without express or implied warranty of any kind.
These notices must be retained in any copies of any part of this
documentation and/or software.
 */</span>

<span class="d Compound"><span class="d Module"><span class="k">module</span> <span class="i">std</span>.<span class="i">md5</span>;</span>

<span class="lc">//debug=md5;		// uncomment to turn on debugging printf's</span>

<span class="d Import"><span class="k">import</span> <span class="i">std</span>.<span class="i">string</span>;</span>

<span class="bc">/***************************************
 * Computes MD5 digest of array of data.
 */</span>

<span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">sum</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span> <span class="i">digest</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">void</span></span><span class="t Array">[]</span> <span class="i">data</span></span>)</span>
<span class="s FuncBody"><span class="s Compound">{
    <span class="s Declaration"><span class="d Variables"><span class="t Identifier"><span class="i">MD5_CTX</span></span> <span class="i">context</span>;</span></span>

    <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Identifier"><span class="i">context</span></span>.<span class="e Identifier"><span class="i">start</span></span></span>()</span>;</span>
    <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Identifier"><span class="i">context</span></span>.<span class="e Identifier"><span class="i">update</span></span></span>(<span class="i">data</span>)</span>;</span>
    <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Identifier"><span class="i">context</span></span>.<span class="e Identifier"><span class="i">finish</span></span></span>(<span class="i">digest</span>)</span>;</span>
}</span></span></span>

<span class="bc">/******************
 * Prints a message digest in hexadecimal to stdout.
 */</span>
<span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">printDigest</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span> <span class="i">digest</span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span></span>)</span>
<span class="s FuncBody"><span class="s Compound">{
    <span class="s Foreach"><span class="k">foreach</span> (<span class="o Parameters"><span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span> <span class="i">u</span></span></span>; <span class="e Identifier"><span class="i">digest</span></span>)
	<span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">printf</span></span>(<span class="sl">"%02x"</span>, <span class="i">u</span>)</span>;</span></span>
}</span></span></span>

<span class="bc">/****************************************
 * Converts MD5 digest to a string.
 */</span>

<span class="d Function"><span class="t Integral"><span class="k">char</span></span><span class="t Array">[]</span> <span class="i">digestToString</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span> <span class="i">digest</span></span>)</span>
<span class="s FuncBody"><span class="s Compound">{
    <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">char</span></span><span class="t Array">[]</span> <span class="i">result</span> = <span class="e New"><span class="k">new</span> <span class="t Integral"><span class="k">char</span></span><span class="t Array">[<span class="e Int"><span class="n">32</span></span>]</span></span>;</span></span>
    <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">int</span></span> <span class="i">i</span>;</span></span>

    <span class="s Foreach"><span class="k">foreach</span> (<span class="o Parameters"><span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span> <span class="i">u</span></span></span>; <span class="e Identifier"><span class="i">digest</span></span>)
    <span class="s Compound">{
	<span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">result</span></span>[<span class="e Identifier"><span class="i">i</span></span>]</span> = <span class="e Index"><span class="e Dot"><span class="e Dot"><span class="e Identifier"><span class="i">std</span></span>.<span class="e Identifier"><span class="i">string</span></span></span>.<span class="e Identifier"><span class="i">hexdigits</span></span></span>[<span class="e RShift"><span class="e Identifier"><span class="i">u</span></span> &gt;&gt; <span class="e Int"><span class="n">4</span></span></span>]</span></span>;</span>
	<span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">result</span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">i</span></span> + <span class="e Int"><span class="n">1</span></span></span>]</span> = <span class="e Index"><span class="e Dot"><span class="e Dot"><span class="e Identifier"><span class="i">std</span></span>.<span class="e Identifier"><span class="i">string</span></span></span>.<span class="e Identifier"><span class="i">hexdigits</span></span></span>[<span class="e And"><span class="e Identifier"><span class="i">u</span></span> &amp; <span class="e Int"><span class="n">15</span></span></span>]</span></span>;</span>
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">i</span></span> += <span class="e Int"><span class="n">2</span></span></span>;</span>
    }</span></span>
    <span class="s Return"><span class="k">return</span> <span class="e Identifier"><span class="i">result</span></span>;</span>
}</span></span></span>

<span class="bc">/**
 * Holds context of MD5 computation.
 *
 * Used when data to be digested is buffered.
 */</span>
<span class="d Struct"><span class="k">struct</span> <span class="i">MD5_CTX</span>
<span class="d Compound">{
    <span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">state</span><span class="t Array">[<span class="e Int"><span class="n">4</span></span>]</span> =                                   <span class="bc">/* state (ABCD) */</span>
    <span class="bc">/* magic initialization constants */</span>
    <span class="e ArrayInit">[<span class="e Int"><span class="n">0x67452301</span></span>,<span class="e Int"><span class="n">0xefcdab89</span></span>,<span class="e Int"><span class="n">0x98badcfe</span></span>,<span class="e Int"><span class="n">0x10325476</span></span>]</span>;</span>

    <span class="d Variables"><span class="t Integral"><span class="k">ulong</span></span> <span class="i">count</span>;</span>	<span class="bc">/* number of bits, modulo 2^64 */</span>
    <span class="d Variables"><span class="t Integral"><span class="k">ubyte</span></span> <span class="i">buffer</span><span class="t Array">[<span class="e Int"><span class="n">64</span></span>]</span>;</span>	<span class="bc">/* input buffer */</span>

    <span class="d StorageClass"><span class="k">static</span> <span class="d Variables"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[<span class="e Int"><span class="n">64</span></span>]</span> <span class="i">PADDING</span> =
    <span class="e ArrayInit">[
      <span class="e Int"><span class="n">0x80</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>,
      <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>,
      <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>, <span class="e Int"><span class="n">0</span></span>
    ]</span>;</span></span>

    <span class="bc">/* F, G, H and I are basic MD5 functions.
     */</span>
    <span class="d Protection"><span class="k">private</span> <span class="d StorageClass"><span class="k">static</span>
    <span class="d Compound">{
	<span class="d Function"><span class="t Integral"><span class="k">uint</span></span> <span class="i">F</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">y</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">z</span></span>)</span> <span class="s FuncBody"><span class="s Compound">{ <span class="s Return"><span class="k">return</span> <span class="e Or"><span class="e Paren">(<span class="e And"><span class="e Identifier"><span class="i">x</span></span> &amp; <span class="e Identifier"><span class="i">y</span></span></span>)</span> | <span class="e Paren">(<span class="e And"><span class="e Comp">~<span class="e Identifier"><span class="i">x</span></span></span> &amp; <span class="e Identifier"><span class="i">z</span></span></span>)</span></span>;</span> }</span></span></span>
	<span class="d Function"><span class="t Integral"><span class="k">uint</span></span> <span class="i">G</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">y</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">z</span></span>)</span> <span class="s FuncBody"><span class="s Compound">{ <span class="s Return"><span class="k">return</span> <span class="e Or"><span class="e Paren">(<span class="e And"><span class="e Identifier"><span class="i">x</span></span> &amp; <span class="e Identifier"><span class="i">z</span></span></span>)</span> | <span class="e Paren">(<span class="e And"><span class="e Identifier"><span class="i">y</span></span> &amp; <span class="e Comp">~<span class="e Identifier"><span class="i">z</span></span></span></span>)</span></span>;</span> }</span></span></span>
	<span class="d Function"><span class="t Integral"><span class="k">uint</span></span> <span class="i">H</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">y</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">z</span></span>)</span> <span class="s FuncBody"><span class="s Compound">{ <span class="s Return"><span class="k">return</span> <span class="e Xor"><span class="e Xor"><span class="e Identifier"><span class="i">x</span></span> ^ <span class="e Identifier"><span class="i">y</span></span></span> ^ <span class="e Identifier"><span class="i">z</span></span></span>;</span> }</span></span></span>
	<span class="d Function"><span class="t Integral"><span class="k">uint</span></span> <span class="i">I</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">y</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">z</span></span>)</span> <span class="s FuncBody"><span class="s Compound">{ <span class="s Return"><span class="k">return</span> <span class="e Xor"><span class="e Identifier"><span class="i">y</span></span> ^ <span class="e Paren">(<span class="e Or"><span class="e Identifier"><span class="i">x</span></span> | <span class="e Comp">~<span class="e Identifier"><span class="i">z</span></span></span></span>)</span></span>;</span> }</span></span></span>
    }</span></span></span>

    <span class="bc">/* ROTATE_LEFT rotates x left n bits.
     */</span>
    <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">uint</span></span> <span class="i">ROTATE_LEFT</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">n</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Version"><span class="k">version</span> (<span class="i">X86</span>)
	<span class="s Compound">{
	    <span class="s AsmBlock"><span class="k">asm</span>
	    {   <span class="s Asm"><span class="i">naked</span>			;</span>
		<span class="s Asm"><span class="i">mov</span>	<span class="e AsmRegister"><span class="i">ECX</span></span>,<span class="e AsmRegister"><span class="i">EAX</span></span>		;</span>
		<span class="s Asm"><span class="i">mov</span>	<span class="e AsmRegister"><span class="i">EAX</span></span>,<span class="e AsmPostBracket"><span class="e Int"><span class="n">4</span></span>[<span class="e AsmRegister"><span class="i">ESP</span></span>]</span>	;</span>
		<span class="s Asm"><span class="i">rol</span>	<span class="e AsmRegister"><span class="i">EAX</span></span>,<span class="e AsmRegister"><span class="i">CL</span></span>		;</span>
		<span class="s Asm"><span class="i">ret</span>	<span class="e Int"><span class="n">4</span></span>		;</span>
	    }</span>
	}</span>
	<span class="k">else</span>
	<span class="s Compound">{
	    <span class="s Return"><span class="k">return</span> <span class="e Or"><span class="e Paren">(<span class="e LShift"><span class="e Identifier"><span class="i">x</span></span> &lt;&lt; <span class="e Identifier"><span class="i">n</span></span></span>)</span> | <span class="e Paren">(<span class="e RShift"><span class="e Identifier"><span class="i">x</span></span> &gt;&gt; <span class="e Paren">(<span class="e Minus"><span class="e Int"><span class="n">32</span></span>-<span class="e Identifier"><span class="i">n</span></span></span>)</span></span>)</span></span>;</span>
	}</span></span>
    }</span></span></span></span>

    <span class="bc">/* FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
     * Rotation is separate from addition to prevent recomputation.
     */</span>
    <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">FF</span><span class="o Parameters">(<span class="o Parameter"><span class="k">inout</span> <span class="t Integral"><span class="k">uint</span></span> <span class="i">a</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">b</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">c</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">d</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">s</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">ac</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Plus"><span class="e Plus"><span class="e Call"><span class="e Identifier"><span class="i">F</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>)</span> + <span class="e Identifier"><span class="i">x</span></span></span> + <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Paren">(<span class="e Identifier"><span class="i">ac</span></span>)</span></span></span></span>;</span>
	<span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">a</span></span> = <span class="e Call"><span class="e Identifier"><span class="i">ROTATE_LEFT</span></span> (<span class="i">a</span>, <span class="i">s</span>)</span></span>;</span>
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Identifier"><span class="i">b</span></span></span>;</span>
    }</span></span></span></span>

    <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">GG</span><span class="o Parameters">(<span class="o Parameter"><span class="k">inout</span> <span class="t Integral"><span class="k">uint</span></span> <span class="i">a</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">b</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">c</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">d</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">s</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">ac</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Plus"><span class="e Plus"><span class="e Call"><span class="e Identifier"><span class="i">G</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>)</span> + <span class="e Identifier"><span class="i">x</span></span></span> + <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Paren">(<span class="e Identifier"><span class="i">ac</span></span>)</span></span></span></span>;</span>
	<span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">a</span></span> = <span class="e Call"><span class="e Identifier"><span class="i">ROTATE_LEFT</span></span> (<span class="i">a</span>, <span class="i">s</span>)</span></span>;</span>
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Identifier"><span class="i">b</span></span></span>;</span>
    }</span></span></span></span>

    <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">HH</span><span class="o Parameters">(<span class="o Parameter"><span class="k">inout</span> <span class="t Integral"><span class="k">uint</span></span> <span class="i">a</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">b</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">c</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">d</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">s</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">ac</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Plus"><span class="e Plus"><span class="e Call"><span class="e Identifier"><span class="i">H</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>)</span> + <span class="e Identifier"><span class="i">x</span></span></span> + <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Paren">(<span class="e Identifier"><span class="i">ac</span></span>)</span></span></span></span>;</span>
	<span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">a</span></span> = <span class="e Call"><span class="e Identifier"><span class="i">ROTATE_LEFT</span></span> (<span class="i">a</span>, <span class="i">s</span>)</span></span>;</span>
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Identifier"><span class="i">b</span></span></span>;</span>
    }</span></span></span></span>

    <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">II</span><span class="o Parameters">(<span class="o Parameter"><span class="k">inout</span> <span class="t Integral"><span class="k">uint</span></span> <span class="i">a</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">b</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">c</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">d</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">x</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">s</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">ac</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Plus"><span class="e Plus"><span class="e Call"><span class="e Identifier"><span class="i">I</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>)</span> + <span class="e Identifier"><span class="i">x</span></span></span> + <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Paren">(<span class="e Identifier"><span class="i">ac</span></span>)</span></span></span></span>;</span>
	<span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">a</span></span> = <span class="e Call"><span class="e Identifier"><span class="i">ROTATE_LEFT</span></span> (<span class="i">a</span>, <span class="i">s</span>)</span></span>;</span>
	<span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">a</span></span> += <span class="e Identifier"><span class="i">b</span></span></span>;</span>
    }</span></span></span></span>

    <span class="bc">/**
     * MD5 initialization. Begins an MD5 operation, writing a new context.
     */</span>
    <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">start</span><span class="o Parameters">()</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Expression"><span class="e Assign"><span class="e Deref">*<span class="e This"><span class="k">this</span></span></span> = <span class="e Dot"><span class="e Identifier"><span class="i">MD5_CTX</span></span>.<span class="e Identifier"><span class="i">init</span></span></span></span>;</span>
    }</span></span></span>

    <span class="bc">/** MD5 block update operation. Continues an MD5 message-digest
      operation, processing another message block, and updating the
      context.
     */</span>
    <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">update</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">void</span></span><span class="t Array">[]</span> <span class="i">input</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">i</span>, <span class="i">index</span>, <span class="i">partLen</span>;</span></span>
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">inputLen</span> = <span class="e Dot"><span class="e Identifier"><span class="i">input</span></span>.<span class="e Identifier"><span class="i">length</span></span></span>;</span></span>

      <span class="bc">/* Compute number of bytes mod 64 */</span>
      <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">index</span></span> = <span class="e And"><span class="e Paren">(<span class="e RShift"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">count</span></span></span> &gt;&gt; <span class="e Int"><span class="n">3</span></span></span>)</span> &amp; <span class="e Paren">(<span class="e Minus"><span class="e Int"><span class="n">64</span></span> - <span class="e Int"><span class="n">1</span></span></span>)</span></span></span>;</span>

      <span class="bc">/* Update number of bits */</span>
      <span class="s Expression"><span class="e PlusAssign"><span class="e Identifier"><span class="i">count</span></span> += <span class="e Mul"><span class="e Identifier"><span class="i">inputLen</span></span> * <span class="e Int"><span class="n">8</span></span></span></span>;</span>

      <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">partLen</span></span> = <span class="e Minus"><span class="e Int"><span class="n">64</span></span> - <span class="e Identifier"><span class="i">index</span></span></span></span>;</span>

      <span class="bc">/* Transform as many times as possible. */</span>
      <span class="s If"><span class="k">if</span> (<span class="e Rel"><span class="e Identifier"><span class="i">inputLen</span></span> &gt;= <span class="e Identifier"><span class="i">partLen</span></span></span>)
      <span class="s Compound">{
	    <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Dot"><span class="e Dot"><span class="e Identifier"><span class="i">std</span></span>.<span class="e Identifier"><span class="i">c</span></span></span>.<span class="e Identifier"><span class="i">string</span></span></span>.<span class="e Identifier"><span class="i">memcpy</span></span></span>(&amp;<span class="i">buffer</span>[<span class="i">index</span>], <span class="i">input</span>.<span class="i">ptr</span>, <span class="i">partLen</span>)</span>;</span>
	    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">transform</span></span> (<span class="i">buffer</span>.<span class="i">ptr</span>)</span>;</span>

	    <span class="s For"><span class="k">for</span> (<span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">i</span></span> = <span class="e Identifier"><span class="i">partLen</span></span></span>;</span> <span class="e Rel"><span class="e Plus"><span class="e Identifier"><span class="i">i</span></span> + <span class="e Int"><span class="n">63</span></span></span> &lt; <span class="e Identifier"><span class="i">inputLen</span></span></span>; <span class="e PlusAssign"><span class="e Identifier"><span class="i">i</span></span> += <span class="e Int"><span class="n">64</span></span></span>)
	       <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">transform</span></span> ((<span class="k">cast</span>(<span class="k">ubyte</span>[])<span class="i">input</span>)[<span class="i">i</span> .. <span class="i">i</span> + <span class="n">64</span>].<span class="i">ptr</span>)</span>;</span></span>

	    <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">index</span></span> = <span class="e Int"><span class="n">0</span></span></span>;</span>
      }</span>
      <span class="k">else</span>
	    <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">i</span></span> = <span class="e Int"><span class="n">0</span></span></span>;</span></span>

      <span class="bc">/* Buffer remaining input */</span>
      <span class="s If"><span class="k">if</span> (<span class="e Minus"><span class="e Identifier"><span class="i">inputLen</span></span> - <span class="e Identifier"><span class="i">i</span></span></span>)
	    <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Dot"><span class="e Dot"><span class="e Identifier"><span class="i">std</span></span>.<span class="e Identifier"><span class="i">c</span></span></span>.<span class="e Identifier"><span class="i">string</span></span></span>.<span class="e Identifier"><span class="i">memcpy</span></span></span>(&amp;<span class="i">buffer</span>[<span class="i">index</span>], &amp;<span class="i">input</span>[<span class="i">i</span>], <span class="i">inputLen</span>-<span class="i">i</span>)</span>;</span></span>
    }</span></span></span>

    <span class="bc">/** MD5 finalization. Ends an MD5 message-digest operation, writing the
     * the message to digest and zeroing the context.
     */</span>
    <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">finish</span><span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span> <span class="i">digest</span></span>)</span>         <span class="bc">/* message digest */</span>
    <span class="s FuncBody"><span class="s Compound">{
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">ubyte</span></span> <span class="i">bits</span><span class="t Array">[<span class="e Int"><span class="n">8</span></span>]</span>;</span></span>
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">index</span>, <span class="i">padLen</span>;</span></span>
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span><span class="t Array">[<span class="e Int"><span class="n">2</span></span>]</span> <span class="i">cnt</span>;</span></span>

      <span class="bc">/* Save number of bits */</span>
      <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">cnt</span></span>[<span class="e Int"><span class="n">0</span></span>]</span> = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">count</span></span></span></span>;</span>
      <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">cnt</span></span>[<span class="e Int"><span class="n">1</span></span>]</span> = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Paren">(<span class="e RShift"><span class="e Identifier"><span class="i">count</span></span> &gt;&gt; <span class="e Int"><span class="n">32</span></span></span>)</span></span></span>;</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">Encode</span></span> (<span class="i">bits</span>.<span class="i">ptr</span>, <span class="i">cnt</span>.<span class="i">ptr</span>, <span class="n">8</span>)</span>;</span>

      <span class="bc">/* Pad out to 56 mod 64. */</span>
      <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">index</span></span> = <span class="e And"><span class="e Paren">(<span class="e RShift"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">count</span></span></span> &gt;&gt; <span class="e Int"><span class="n">3</span></span></span>)</span> &amp; <span class="e Paren">(<span class="e Minus"><span class="e Int"><span class="n">64</span></span> - <span class="e Int"><span class="n">1</span></span></span>)</span></span></span>;</span>
      <span class="s Expression"><span class="e Assign"><span class="e Identifier"><span class="i">padLen</span></span> = <span class="e Cond"><span class="e Paren">(<span class="e Rel"><span class="e Identifier"><span class="i">index</span></span> &lt; <span class="e Int"><span class="n">56</span></span></span>)</span> ? <span class="e Paren">(<span class="e Minus"><span class="e Int"><span class="n">56</span></span> - <span class="e Identifier"><span class="i">index</span></span></span>)</span> : <span class="e Paren">(<span class="e Minus"><span class="e Int"><span class="n">120</span></span> - <span class="e Identifier"><span class="i">index</span></span></span>)</span></span></span>;</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">update</span></span> (<span class="i">PADDING</span>[<span class="n">0</span> .. <span class="i">padLen</span>])</span>;</span>

      <span class="bc">/* Append length (before padding) */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">update</span></span> (<span class="i">bits</span>)</span>;</span>

      <span class="bc">/* Store state in digest */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">Encode</span></span> (<span class="i">digest</span>.<span class="i">ptr</span>, <span class="i">state</span>.<span class="i">ptr</span>, <span class="n">16</span>)</span>;</span>

      <span class="bc">/* Zeroize sensitive information. */</span>
      <span class="s Expression"><span class="e Call"><span class="e Dot"><span class="e Dot"><span class="e Dot"><span class="e Identifier"><span class="i">std</span></span>.<span class="e Identifier"><span class="i">c</span></span></span>.<span class="e Identifier"><span class="i">string</span></span></span>.<span class="e Identifier"><span class="i">memset</span></span></span> (<span class="k">this</span>, <span class="n">0</span>, <span class="i">MD5_CTX</span>.<span class="i">sizeof</span>)</span>;</span>
    }</span></span></span>

    <span class="bc">/* MD5 basic transformation. Transforms state based on block.
     */</span>

    <span class="bc">/* Constants for MD5Transform routine. */</span>
    <span class="d Enum"><span class="k">enum</span>
    {
	<span class="d EnumMember"><span class="i">S11</span> = <span class="e Int"><span class="n">7</span></span></span>,
	<span class="d EnumMember"><span class="i">S12</span> = <span class="e Int"><span class="n">12</span></span></span>,
	<span class="d EnumMember"><span class="i">S13</span> = <span class="e Int"><span class="n">17</span></span></span>,
	<span class="d EnumMember"><span class="i">S14</span> = <span class="e Int"><span class="n">22</span></span></span>,
	<span class="d EnumMember"><span class="i">S21</span> = <span class="e Int"><span class="n">5</span></span></span>,
	<span class="d EnumMember"><span class="i">S22</span> = <span class="e Int"><span class="n">9</span></span></span>,
	<span class="d EnumMember"><span class="i">S23</span> = <span class="e Int"><span class="n">14</span></span></span>,
	<span class="d EnumMember"><span class="i">S24</span> = <span class="e Int"><span class="n">20</span></span></span>,
	<span class="d EnumMember"><span class="i">S31</span> = <span class="e Int"><span class="n">4</span></span></span>,
	<span class="d EnumMember"><span class="i">S32</span> = <span class="e Int"><span class="n">11</span></span></span>,
	<span class="d EnumMember"><span class="i">S33</span> = <span class="e Int"><span class="n">16</span></span></span>,
	<span class="d EnumMember"><span class="i">S34</span> = <span class="e Int"><span class="n">23</span></span></span>,
	<span class="d EnumMember"><span class="i">S41</span> = <span class="e Int"><span class="n">6</span></span></span>,
	<span class="d EnumMember"><span class="i">S42</span> = <span class="e Int"><span class="n">10</span></span></span>,
	<span class="d EnumMember"><span class="i">S43</span> = <span class="e Int"><span class="n">15</span></span></span>,
	<span class="d EnumMember"><span class="i">S44</span> = <span class="e Int"><span class="n">21</span></span></span>,
    }</span>

    <span class="d Protection"><span class="k">private</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">transform</span> <span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Pointer">*</span> <span class="bc">/*[64]*/</span> <span class="i">block</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">a</span> = <span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">0</span></span>]</span>,
	   <span class="i">b</span> = <span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">1</span></span>]</span>,
	   <span class="i">c</span> = <span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">2</span></span>]</span>,
	   <span class="i">d</span> = <span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">3</span></span>]</span>;</span></span>
      <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span> <span class="i">x</span>;</span></span>

      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">Decode</span></span> (<span class="i">x</span>.<span class="i">ptr</span>, <span class="i">block</span>, <span class="n">64</span>)</span>;</span>

      <span class="bc">/* Round 1 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">0</span>], <span class="i">S11</span>, <span class="n">0xd76aa478</span>)</span>;</span> <span class="bc">/* 1 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">1</span>], <span class="i">S12</span>, <span class="n">0xe8c7b756</span>)</span>;</span> <span class="bc">/* 2 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">2</span>], <span class="i">S13</span>, <span class="n">0x242070db</span>)</span>;</span> <span class="bc">/* 3 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">3</span>], <span class="i">S14</span>, <span class="n">0xc1bdceee</span>)</span>;</span> <span class="bc">/* 4 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">4</span>], <span class="i">S11</span>, <span class="n">0xf57c0faf</span>)</span>;</span> <span class="bc">/* 5 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">5</span>], <span class="i">S12</span>, <span class="n">0x4787c62a</span>)</span>;</span> <span class="bc">/* 6 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">6</span>], <span class="i">S13</span>, <span class="n">0xa8304613</span>)</span>;</span> <span class="bc">/* 7 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">7</span>], <span class="i">S14</span>, <span class="n">0xfd469501</span>)</span>;</span> <span class="bc">/* 8 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">8</span>], <span class="i">S11</span>, <span class="n">0x698098d8</span>)</span>;</span> <span class="bc">/* 9 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">9</span>], <span class="i">S12</span>, <span class="n">0x8b44f7af</span>)</span>;</span> <span class="bc">/* 10 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">10</span>], <span class="i">S13</span>, <span class="n">0xffff5bb1</span>)</span>;</span> <span class="bc">/* 11 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">11</span>], <span class="i">S14</span>, <span class="n">0x895cd7be</span>)</span>;</span> <span class="bc">/* 12 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[<span class="n">12</span>], <span class="i">S11</span>, <span class="n">0x6b901122</span>)</span>;</span> <span class="bc">/* 13 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">13</span>], <span class="i">S12</span>, <span class="n">0xfd987193</span>)</span>;</span> <span class="bc">/* 14 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">14</span>], <span class="i">S13</span>, <span class="n">0xa679438e</span>)</span>;</span> <span class="bc">/* 15 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">FF</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">15</span>], <span class="i">S14</span>, <span class="n">0x49b40821</span>)</span>;</span> <span class="bc">/* 16 */</span>

     <span class="bc">/* Round 2 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">1</span>], <span class="i">S21</span>, <span class="n">0xf61e2562</span>)</span>;</span> <span class="bc">/* 17 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">6</span>], <span class="i">S22</span>, <span class="n">0xc040b340</span>)</span>;</span> <span class="bc">/* 18 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">11</span>], <span class="i">S23</span>, <span class="n">0x265e5a51</span>)</span>;</span> <span class="bc">/* 19 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">0</span>], <span class="i">S24</span>, <span class="n">0xe9b6c7aa</span>)</span>;</span> <span class="bc">/* 20 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">5</span>], <span class="i">S21</span>, <span class="n">0xd62f105d</span>)</span>;</span> <span class="bc">/* 21 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">10</span>], <span class="i">S22</span>,  <span class="n">0x2441453</span>)</span>;</span> <span class="bc">/* 22 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">15</span>], <span class="i">S23</span>, <span class="n">0xd8a1e681</span>)</span>;</span> <span class="bc">/* 23 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">4</span>], <span class="i">S24</span>, <span class="n">0xe7d3fbc8</span>)</span>;</span> <span class="bc">/* 24 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">9</span>], <span class="i">S21</span>, <span class="n">0x21e1cde6</span>)</span>;</span> <span class="bc">/* 25 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">14</span>], <span class="i">S22</span>, <span class="n">0xc33707d6</span>)</span>;</span> <span class="bc">/* 26 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">3</span>], <span class="i">S23</span>, <span class="n">0xf4d50d87</span>)</span>;</span> <span class="bc">/* 27 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">8</span>], <span class="i">S24</span>, <span class="n">0x455a14ed</span>)</span>;</span> <span class="bc">/* 28 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[<span class="n">13</span>], <span class="i">S21</span>, <span class="n">0xa9e3e905</span>)</span>;</span> <span class="bc">/* 29 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">2</span>], <span class="i">S22</span>, <span class="n">0xfcefa3f8</span>)</span>;</span> <span class="bc">/* 30 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">7</span>], <span class="i">S23</span>, <span class="n">0x676f02d9</span>)</span>;</span> <span class="bc">/* 31 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">GG</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">12</span>], <span class="i">S24</span>, <span class="n">0x8d2a4c8a</span>)</span>;</span> <span class="bc">/* 32 */</span>

      <span class="bc">/* Round 3 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">5</span>], <span class="i">S31</span>, <span class="n">0xfffa3942</span>)</span>;</span> <span class="bc">/* 33 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">8</span>], <span class="i">S32</span>, <span class="n">0x8771f681</span>)</span>;</span> <span class="bc">/* 34 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">11</span>], <span class="i">S33</span>, <span class="n">0x6d9d6122</span>)</span>;</span> <span class="bc">/* 35 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">14</span>], <span class="i">S34</span>, <span class="n">0xfde5380c</span>)</span>;</span> <span class="bc">/* 36 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">1</span>], <span class="i">S31</span>, <span class="n">0xa4beea44</span>)</span>;</span> <span class="bc">/* 37 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">4</span>], <span class="i">S32</span>, <span class="n">0x4bdecfa9</span>)</span>;</span> <span class="bc">/* 38 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">7</span>], <span class="i">S33</span>, <span class="n">0xf6bb4b60</span>)</span>;</span> <span class="bc">/* 39 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">10</span>], <span class="i">S34</span>, <span class="n">0xbebfbc70</span>)</span>;</span> <span class="bc">/* 40 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[<span class="n">13</span>], <span class="i">S31</span>, <span class="n">0x289b7ec6</span>)</span>;</span> <span class="bc">/* 41 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">0</span>], <span class="i">S32</span>, <span class="n">0xeaa127fa</span>)</span>;</span> <span class="bc">/* 42 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">3</span>], <span class="i">S33</span>, <span class="n">0xd4ef3085</span>)</span>;</span> <span class="bc">/* 43 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">6</span>], <span class="i">S34</span>,  <span class="n">0x4881d05</span>)</span>;</span> <span class="bc">/* 44 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">9</span>], <span class="i">S31</span>, <span class="n">0xd9d4d039</span>)</span>;</span> <span class="bc">/* 45 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">12</span>], <span class="i">S32</span>, <span class="n">0xe6db99e5</span>)</span>;</span> <span class="bc">/* 46 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">15</span>], <span class="i">S33</span>, <span class="n">0x1fa27cf8</span>)</span>;</span> <span class="bc">/* 47 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">HH</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">2</span>], <span class="i">S34</span>, <span class="n">0xc4ac5665</span>)</span>;</span> <span class="bc">/* 48 */</span>

      <span class="bc">/* Round 4 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">0</span>], <span class="i">S41</span>, <span class="n">0xf4292244</span>)</span>;</span> <span class="bc">/* 49 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">7</span>], <span class="i">S42</span>, <span class="n">0x432aff97</span>)</span>;</span> <span class="bc">/* 50 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">14</span>], <span class="i">S43</span>, <span class="n">0xab9423a7</span>)</span>;</span> <span class="bc">/* 51 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">5</span>], <span class="i">S44</span>, <span class="n">0xfc93a039</span>)</span>;</span> <span class="bc">/* 52 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[<span class="n">12</span>], <span class="i">S41</span>, <span class="n">0x655b59c3</span>)</span>;</span> <span class="bc">/* 53 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[ <span class="n">3</span>], <span class="i">S42</span>, <span class="n">0x8f0ccc92</span>)</span>;</span> <span class="bc">/* 54 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[<span class="n">10</span>], <span class="i">S43</span>, <span class="n">0xffeff47d</span>)</span>;</span> <span class="bc">/* 55 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">1</span>], <span class="i">S44</span>, <span class="n">0x85845dd1</span>)</span>;</span> <span class="bc">/* 56 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">8</span>], <span class="i">S41</span>, <span class="n">0x6fa87e4f</span>)</span>;</span> <span class="bc">/* 57 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">15</span>], <span class="i">S42</span>, <span class="n">0xfe2ce6e0</span>)</span>;</span> <span class="bc">/* 58 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">6</span>], <span class="i">S43</span>, <span class="n">0xa3014314</span>)</span>;</span> <span class="bc">/* 59 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[<span class="n">13</span>], <span class="i">S44</span>, <span class="n">0x4e0811a1</span>)</span>;</span> <span class="bc">/* 60 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">x</span>[ <span class="n">4</span>], <span class="i">S41</span>, <span class="n">0xf7537e82</span>)</span>;</span> <span class="bc">/* 61 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">c</span>, <span class="i">x</span>[<span class="n">11</span>], <span class="i">S42</span>, <span class="n">0xbd3af235</span>)</span>;</span> <span class="bc">/* 62 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">b</span>, <span class="i">x</span>[ <span class="n">2</span>], <span class="i">S43</span>, <span class="n">0x2ad7d2bb</span>)</span>;</span> <span class="bc">/* 63 */</span>
      <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">II</span></span> (<span class="i">b</span>, <span class="i">c</span>, <span class="i">d</span>, <span class="i">a</span>, <span class="i">x</span>[ <span class="n">9</span>], <span class="i">S44</span>, <span class="n">0xeb86d391</span>)</span>;</span> <span class="bc">/* 64 */</span>

      <span class="s Expression"><span class="e PlusAssign"><span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">0</span></span>]</span> += <span class="e Identifier"><span class="i">a</span></span></span>;</span>
      <span class="s Expression"><span class="e PlusAssign"><span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">1</span></span>]</span> += <span class="e Identifier"><span class="i">b</span></span></span>;</span>
      <span class="s Expression"><span class="e PlusAssign"><span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">2</span></span>]</span> += <span class="e Identifier"><span class="i">c</span></span></span>;</span>
      <span class="s Expression"><span class="e PlusAssign"><span class="e Index"><span class="e Identifier"><span class="i">state</span></span>[<span class="e Int"><span class="n">3</span></span>]</span> += <span class="e Identifier"><span class="i">d</span></span></span>;</span>

      <span class="bc">/* Zeroize sensitive information. */</span>
      <span class="s Expression"><span class="e Assign"><span class="e Slice"><span class="e Identifier"><span class="i">x</span></span>[]</span> = <span class="e Int"><span class="n">0</span></span></span>;</span>
    }</span></span></span></span>

    <span class="bc">/* Encodes input (uint) into output (ubyte). Assumes len is
      a multiple of 4.
     */</span>
    <span class="d Protection"><span class="k">private</span> <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">Encode</span> <span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span> <span class="t Pointer">*</span><span class="i">output</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="t Pointer">*</span><span class="i">input</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">len</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">i</span>, <span class="i">j</span>;</span></span>

	<span class="s For"><span class="k">for</span> (<span class="s Expression"><span class="e Comma"><span class="e Assign"><span class="e Identifier"><span class="i">i</span></span> = <span class="e Int"><span class="n">0</span></span></span>, <span class="e Assign"><span class="e Identifier"><span class="i">j</span></span> = <span class="e Int"><span class="n">0</span></span></span></span>;</span> <span class="e Rel"><span class="e Identifier"><span class="i">j</span></span> &lt; <span class="e Identifier"><span class="i">len</span></span></span>; <span class="e Comma"><span class="e PostIncr"><span class="e Identifier"><span class="i">i</span></span>++</span>, <span class="e PlusAssign"><span class="e Identifier"><span class="i">j</span></span> += <span class="e Int"><span class="n">4</span></span></span></span>)
	<span class="s Compound">{
	    <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">u</span> = <span class="e Index"><span class="e Identifier"><span class="i">input</span></span>[<span class="e Identifier"><span class="i">i</span></span>]</span>;</span></span>
	    <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Identifier"><span class="i">j</span></span>]</span>   = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span>)<span class="e Paren">(<span class="e Identifier"><span class="i">u</span></span>)</span></span></span>;</span>
	    <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">1</span></span></span>]</span> = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span>)<span class="e Paren">(<span class="e RShift"><span class="e Identifier"><span class="i">u</span></span> &gt;&gt; <span class="e Int"><span class="n">8</span></span></span>)</span></span></span>;</span>
	    <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">2</span></span></span>]</span> = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span>)<span class="e Paren">(<span class="e RShift"><span class="e Identifier"><span class="i">u</span></span> &gt;&gt; <span class="e Int"><span class="n">16</span></span></span>)</span></span></span>;</span>
	    <span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">3</span></span></span>]</span> = <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span>)<span class="e Paren">(<span class="e RShift"><span class="e Identifier"><span class="i">u</span></span> &gt;&gt; <span class="e Int"><span class="n">24</span></span></span>)</span></span></span>;</span>
	}</span></span>
    }</span></span></span></span></span>

    <span class="bc">/* Decodes input (ubyte) into output (uint). Assumes len is
      a multiple of 4.
     */</span>
    <span class="d Protection"><span class="k">private</span> <span class="d StorageClass"><span class="k">static</span> <span class="d Function"><span class="t Integral"><span class="k">void</span></span> <span class="i">Decode</span> <span class="o Parameters">(<span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="t Pointer">*</span><span class="i">output</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">ubyte</span></span> <span class="t Pointer">*</span><span class="i">input</span></span>, <span class="o Parameter"><span class="t Integral"><span class="k">uint</span></span> <span class="i">len</span></span>)</span>
    <span class="s FuncBody"><span class="s Compound">{
	<span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">uint</span></span> <span class="i">i</span>, <span class="i">j</span>;</span></span>

	<span class="s For"><span class="k">for</span> (<span class="s Expression"><span class="e Comma"><span class="e Assign"><span class="e Identifier"><span class="i">i</span></span> = <span class="e Int"><span class="n">0</span></span></span>, <span class="e Assign"><span class="e Identifier"><span class="i">j</span></span> = <span class="e Int"><span class="n">0</span></span></span></span>;</span> <span class="e Rel"><span class="e Identifier"><span class="i">j</span></span> &lt; <span class="e Identifier"><span class="i">len</span></span></span>; <span class="e Comma"><span class="e PostIncr"><span class="e Identifier"><span class="i">i</span></span>++</span>, <span class="e PlusAssign"><span class="e Identifier"><span class="i">j</span></span> += <span class="e Int"><span class="n">4</span></span></span></span>)
	<span class="s Compound">{
	    <span class="s Version"><span class="k">version</span> (<span class="i">LittleEndian</span>)
	    <span class="s Compound">{
		<span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Identifier"><span class="i">i</span></span>]</span> = <span class="e Index"><span class="e Deref">*<span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span><span class="t Pointer">*</span>)<span class="e Address">&amp;<span class="e Identifier"><span class="i">input</span></span></span></span></span>[<span class="e Identifier"><span class="i">j</span></span>]</span></span>;</span>
	    }</span>
	    <span class="k">else</span>
	    <span class="s Compound">{
		<span class="s Expression"><span class="e Assign"><span class="e Index"><span class="e Identifier"><span class="i">output</span></span>[<span class="e Identifier"><span class="i">i</span></span>]</span> = <span class="e Or"><span class="e Or"><span class="e Or"><span class="e Paren">(<span class="e Index"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">input</span></span></span>[<span class="e Identifier"><span class="i">j</span></span>]</span>)</span> | <span class="e Paren">(<span class="e LShift"><span class="e Paren">(<span class="e Index"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">input</span></span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">1</span></span></span>]</span>)</span> &lt;&lt; <span class="e Int"><span class="n">8</span></span></span>)</span></span> |
			<span class="e Paren">(<span class="e LShift"><span class="e Paren">(<span class="e Index"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">input</span></span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">2</span></span></span>]</span>)</span> &lt;&lt; <span class="e Int"><span class="n">16</span></span></span>)</span></span> | <span class="e Paren">(<span class="e LShift"><span class="e Paren">(<span class="e Index"><span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">uint</span></span>)<span class="e Identifier"><span class="i">input</span></span></span>[<span class="e Plus"><span class="e Identifier"><span class="i">j</span></span>+<span class="e Int"><span class="n">3</span></span></span>]</span>)</span> &lt;&lt; <span class="e Int"><span class="n">24</span></span></span>)</span></span></span>;</span>
	    }</span></span>
	}</span></span>
    }</span></span></span></span></span>
}</span></span>

<span class="d Unittest"><span class="k">unittest</span>
<span class="s FuncBody"><span class="s Compound">{
    <span class="s Debug"><span class="k">debug</span>(<span class="i">md5</span>) <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">printf</span></span>(<span class="sl">"std.md5.unittest\n"</span>)</span>;</span></span>

    <span class="s Declaration"><span class="d Variables"><span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[<span class="e Int"><span class="n">16</span></span>]</span> <span class="i">digest</span>;</span></span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">""</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"d41d8cd98f00b204e9800998ecf8427e"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">"a"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"0cc175b9c0f1b6a831c399e269772661"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">"abc"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"900150983cd24fb0d6963f7d28e17f72"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">"message digest"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"f96b697d7cb7938d525a2f31aaf161d0"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">"abcdefghijklmnopqrstuvwxyz"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"c3fcd3d76192e4007dfb496cca67e13b"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>, <span class="sl">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"d174ab98d277d9f5a5611c2c9f419d9f"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Call"><span class="e Identifier"><span class="i">sum</span></span> (<span class="i">digest</span>,
	<span class="sl">"1234567890123456789012345678901234567890"</span>
	<span class="sl">"1234567890123456789012345678901234567890"</span>)</span>;</span>
    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Identifier"><span class="i">digest</span></span> == <span class="e Cast"><span class="k">cast</span>(<span class="t Integral"><span class="k">ubyte</span></span><span class="t Array">[]</span>)<span class="e String"><span class="sl">x"57edf4a22be3c955ac49da2e2107b67a"</span></span></span></span>)</span>;</span>

    <span class="s Expression"><span class="e Assert"><span class="k">assert</span>(<span class="e Equal"><span class="e Call"><span class="e Identifier"><span class="i">digestToString</span></span>(<span class="k">cast</span>(<span class="k">ubyte</span>[<span class="n">16</span>])<span class="sl">x"c3fcd3d76192e4007dfb496cca67e13b"</span>)</span>
        == <span class="e String"><span class="sl">"C3FCD3D76192E4007DFB496CCA67E13B"</span></span></span>)</span>;</span>
}</span></span></span></span>


</pre></td>
</tr></table>
</body>
</html>